diff --git a/src/controllers/adjuntoController.js b/src/controllers/adjuntoController.js
index e085ba6d734462f37bcf324335ba64f8bb59360e..d6e130f479974452c1fc119a58f2c16319bad548 100644
--- a/src/controllers/adjuntoController.js
+++ b/src/controllers/adjuntoController.js
@@ -293,44 +293,64 @@ exports.descargarAdjunto = async (req, res, next) => {
 
     if (!adjunto) {
       return next(new ErrorResponse(`Adjunto no encontrado con id ${req.params.id}`, 404));
     }
 
     const progreso = await ProgresoResidente.findById(adjunto.progreso)
       .populate({ path: 'residente', populate: { path: 'hospital' } });
 
     if (!progreso) {
       return next(new ErrorResponse('Progreso asociado no encontrado', 404));
     }
 
     // Verificar permisos: solo el propio residente, tutores de su hospital o administradores
     if (
       req.user.rol !== 'administrador' &&
       req.user.id !== progreso.residente._id.toString() &&
       (req.user.rol !== 'tutor' ||
         req.user.hospital.toString() !== progreso.residente.hospital._id.toString() ||
         (req.user.especialidad !== 'ALL' && req.user.especialidad !== progreso.residente.especialidad)) &&
       (req.user.rol !== 'csm' || req.user.zona !== progreso.residente.hospital.zona) &&
       (req.user.rol !== 'profesor' || !progreso.residente.sociedad || req.user.sociedad.toString() !== progreso.residente.sociedad.toString())
     ) {
       return next(new ErrorResponse('No autorizado para descargar este adjunto', 403));
     }
 
+    // Descargar desde almacenamiento en base de datos si existe contenido binario
+    if (adjunto.datos && adjunto.datos.length) {
+      await createAuditLog({
+        usuario: req.user._id,
+        accion: 'descargar_adjunto',
+        descripcion: `Adjunto descargado: ${adjunto.nombreArchivo}`,
+        ip: req.ip
+      });
+
+      res.setHeader('Content-Type', adjunto.mimeType || 'application/octet-stream');
+      res.setHeader('Content-Disposition', `attachment; filename="${adjunto.nombreArchivo}"`);
+      res.setHeader('Content-Length', adjunto.datos.length);
+
+      return res.send(adjunto.datos);
+    }
+
+    if (!adjunto.rutaArchivo) {
+      return next(new ErrorResponse('Archivo no disponible', 404));
+    }
+
     const filePath = path.join(__dirname, '../../public', adjunto.rutaArchivo);
-    
+
     if (!fs.existsSync(filePath)) {
       return next(new ErrorResponse('Archivo no encontrado', 404));
     }
 
     // Crear registro de auditorÃ­a
     await createAuditLog({
       usuario: req.user._id,
       accion: 'descargar_adjunto',
       descripcion: `Adjunto descargado: ${adjunto.nombreArchivo}`,
       ip: req.ip
     });
 
     res.download(filePath, adjunto.nombreArchivo);
   } catch (err) {
     next(err);
   }
 };
diff --git a/src/server.js b/src/server.js
index 52e263e01ade0dcd7b8acbd4992131dda741c13b..6c003f4957bb47b2028d7fa4f9966ffdbb48387f 100644
--- a/src/server.js
+++ b/src/server.js
@@ -20,58 +20,64 @@ connectDB();
 const authRoutes = require('./routes/authRoutes');
 const userRoutes = require('./routes/userRoutes');
 const hospitalRoutes = require('./routes/hospitalRoutes');
 const faseRoutes = require('./routes/faseRoutes');
 const actividadRoutes = require('./routes/actividadRoutes');
 const faseSocRoutes = require('./routes/faseSocRoutes');
 const actividadSocRoutes = require('./routes/actividadSocRoutes');
 const progresoRoutes = require('./routes/progresoRoutes');
 const adjuntoRoutes = require('./routes/adjuntoRoutes');
 const notificacionRoutes = require('./routes/notificacionRoutes');
 const adminRoutes = require('./routes/adminRoutes');
 const sociedadesRoutes = require('./routes/sociedadesRoutes');
 const certificadoRoutes = require('./routes/certificadoRoutes');
 const accessCodeRoutes = require('./routes/accessCodeRoutes');
 const surgeryTypeRoutes = require('./routes/surgeryTypeRoutes');
 const informeCirugiasRoutes = require('./routes/informeCirugiasRoutes');
 const informesRoutes = require('./routes/informesRoutes');
 
 // Inicializar app
 const app = express();
 
 // Middlewares esenciales
 app.use(express.json());
 app.use(cookieParser());
 app.use(helmet());
-const clientOrigin = process.env.CLIENT_ORIGIN || 'https://residentlearningplatform.netlify.app';
-const allowedOrigins = Array.from(new Set([
+const envOrigins = process.env.CLIENT_ORIGIN
+  ? process.env.CLIENT_ORIGIN
+      .split(',')
+      .map(origin => origin.trim())
+      .filter(Boolean)
+  : [];
+
+const allowedOrigins = Array.from(new Set([
   'http://localhost:3000',
   'http://localhost:5173',
   'https://residentlearningplatform.netlify.app',
   'https://academicprogramdavinci.netlify.app',
-  clientOrigin,
-]));
+  ...envOrigins,
+]));
 
 const corsOptions = {
   origin: function (origin, callback) {
     if (!origin || allowedOrigins.includes(origin)) {
       callback(null, true);
     } else {
       console.warn(`ðŸ›‘ CORS bloqueado para origen: ${origin}`);
       callback(new Error(`CORS bloqueado: ${origin} no estÃ¡ en la lista de permitidos`));
     }
   },
   credentials: true,
 };
 
 app.use(cors(corsOptions));
 app.options('*', cors(corsOptions)); // Preflight para todos los endpoints
 app.use(fileupload());
 
 // Middleware de desarrollo
 if (process.env.NODE_ENV === 'development') {
   app.use(morgan('dev'));
 }
 
 // Directorio pÃºblico
 app.use(express.static(path.join(__dirname, '../public')));
 
